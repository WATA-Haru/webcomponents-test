<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Custom Element Demo (SSR Shadow DOM)</title>
  </head>
  <body>
    <h1>
      example06. JSをOFFにしてみてください、templateのshadow DOMが描画されています(SSR)
    </h1>
    <!-- shadow DOM の中身を template として定義 -->
    <template id="ssr-my-button-template">
      <style>
        .ssr-my-button {
          font-size: 20px;
          width: 200px;
          height: 100px;
          text-align: center;
          background-color: red;
          color: white;
          border: none;
          border-radius: 8px;
          cursor: pointer;
        }
      </style>
      <button class="ssr-my-button" type="button">SSRed Button</button>
    </template>


    <h1> SSR button</h1>
    <ssr-my-button></ssr-my-button>
    <ssr-my-button></ssr-my-button>
    <ssr-my-button></ssr-my-button>


    <h1> not SSR button</h1>
    <my-button></my-button>
    <my-button></my-button>
    <my-button></my-button>
    <script>
      class MyButton extends HTMLElement {
        constructor() {
          super();
          // Shadow DOM を作成
          this.attachShadow({ mode: "open" });
        }

        connectedCallback() {
          this.shadowRoot.innerHTML = `
            <style>
              .my-button {
                font-size: 20px;
                width: 200px;
                height: 100px;
                text-align: center;
                background-color: green;
                color: white
              }
            </style>
            <button type="button" class="my-button">
              I am custom element<br>
              I am very happy!
            </button>
          `;

          const button = this.shadowRoot.querySelector(".my-button");
          if (button) {
            button.addEventListener("click", () => {
              alert("clicked!");
            });
          }
        }
      }

      window.customElements.define("my-button", MyButton)
      class SSRMyButton extends HTMLElement {
        constructor() {
          super();
          this.attachShadow({ mode: "open" });
        }

        connectedCallback() {
          const template = document.getElementById("ssr-my-button-template");
          const content = template.content.cloneNode(true);
          this.shadowRoot.appendChild(content);

          const button = this.shadowRoot.querySelector(".ssr-my-button");
          if (button) {
            button.addEventListener("click", () => {
              alert("SSRed Shadow DOM clicked!");
            });
          }
        }
      }

      window.customElements.define("ssr-my-button", SSRMyButton);
    </script>
  </body>
</html>